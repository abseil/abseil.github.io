<!DOCTYPE html>
<html lang="en" itemscope itemtype="https://schema.org/WebPage">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="title" content="Abseil open-source foundational code">
    <meta name="description" content="Battle-tested, Mom-approved">
    <title>abseil / Abseil Compiler Guide</title>

    <!-- Fontawesome Icons -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">
    
    <!-- Favicons -->
    <link rel="shortcut icon" type="image/x-icon" href="/favicons/favicon.ico" />
    
    <!-- Bootstrap -->
    <link href="/libs/bootstrap/css/bootstrap.min.css" rel="stylesheet">

    <!-- Site style using SASS, generated by from style.scss -->
    <link rel="stylesheet" href="/css/style.css">

    <!-- Slick styling -->
    <link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/jquery.slick/1.6.0/slick.css"/>
    <link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/jquery.slick/1.6.0/slick-theme.css"/>

    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- metadata -->
    <meta name="og:title" content="abseil / Abseil Compiler Guide"/>
	 <meta name="og:description" content="An open-source collection of core C++ library code"/>
  </head>
  <body class=>

  	<nav id="sticky-nav">
  <div class="nav-container container">
    <div class="row">
      <div class="col-md-11 nofloat center-block">
        <a class="col-xs-2" href="/">
          <img class="nav-logo" src="/img/absl_18px.svg" alt="Abseil">
        </a>

        <div class="col-xs-2 col-xs-offset-8">
          <button type="button" class="hamburger navbar-toggle collapsed" data-target="#navbar-collapse-1">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
        </div>

        <ul class="nav col-xs-10">
          
          <li><a href="/about" >About</a></li>
          <li><a href="/docs/" class='current'>Docs</a></li>
		  <li><a href="/tips/" >Tips</a></li>
          <li><a href="/blog/" >Blog</a></li>
          <li><a href="/community/" >Community</a></li>
        </ul>

      </div>
    </div>
  </div>

  <div class="top-nav right">
    
    <li class="nav-item"><a href="/"><p>Home</p></a><div class="nav-toggle icon-close"></div></li>
    <hr>
    <li class="nav-item"><a href="/about" ><p>About</p></a></li>
    <hr>
    <li class="nav-item"><a href="/docs/" class='current'><p>Docs</p></a>
      <div class="nav-doc-toggle icon-caret"></div>
      <ul class="doc-list">
        <a href="/docs/cpp" ><li class="nav-doc-tab">C++ Devguide</li></a>
        <a href="/docs/cpp/quickstart" ><li class="nav-doc-tab">C++ Quick Start</li></a>
      </ul>
    </li>
    <hr>
    <li class="nav-item"><a href="/tips/" ><p>Tips</p></a></li>
    <hr>
    <li class="nav-item"><a href="/blog/" ><p>Blog</p></a></li>
    <hr>
    <li class="nav-item"><a href="/community/" ><p>Community</p></a></li>
  </div>
</nav>


<div class="nav-hero-container">
	<nav id="common-nav">
  <div class="nav-container container">
    <div class="row">
      <div class="col-md-11 nofloat center-block">
        <a class="col-xs-2" href="/">
          <img class="nav-logo" src="/img/absl_80px.png" alt="Abseil">
        </a>

        <div class="col-xs-2 col-xs-offset-8">
          <button type="button" class="hamburger navbar-toggle collapsed" data-target="#navbar-collapse-1">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
        </div>

        <ul class="nav col-xs-10">
          
          <li><a href="/about" >About</a></li>
          <li><a href="/docs/" class='current'>Docs</a></li>
          <li><a href="/tips/" >C++ Tips</a></li>
		  <li><a href="/blog/" >Blog</a></li>
          <li><a href="/community" >Community</a></li>
        </ul>

      </div>
    </div>
  </div>

  <div class="top-nav right">
    
    <li class="nav-item"><a href="/"><p>Home</p></a><div class="nav-toggle icon-close"></div></li>
    <hr>
    <li class="nav-item"><a href="/about/" ><p>About</p></a></li>
    <hr>
    <li class="nav-item"><a href="/docs/" class='current'><p>Docs</p></a>
      <div class="nav-doc-toggle icon-caret"></div>
      <ul class="doc-list">
        <a href="/docs/cpp/quickstart" ><li class="nav-doc-tab">Quickstart</li></a>
      </ul>
    </li>
    <hr>
    <li class="nav-item"><a href="/blog/" ><p>Blog</p></a></li>
    <hr>
    <li class="nav-item"><a href="/tips/" ><p>Tips</p></a></li>
    <hr>
    <li class="nav-item"><a href="/community/" ><p>Community</p></a></li>
  </div>
  <div class="container">
    <div class="row">
      <div class="col-md-11 nofloat center-block">
        <div class="col-xs-12">
          <h1 class="page-headline"></h1> 
        </div>
      </div>
    </div>
  </div>

</nav>

   <a href="https://github.com/abseil/" class="fork-btn" target="_blank"></a>

</div>



<div class="container">
<div class="row">
<div class="col-md-11 nofloat center-block ">
<div class="col-sm-3">
<ul class="doc-side-nav">
	
	<li><h5 class="doc-side-nav-title"><a href="/docs/">Docs</a></h5></li>
	<li><h5 class="doc-side-nav-title">
	<a href="/docs/cpp.html" class='current'><b>C++ Devguide</b></a></h5></li>
	<li class="doc-side-nav-list-item">
	  <a href="/docs/cpp/quickstart" >
	  Quickstart</a></li>
	  
	<li><h6 class="doc-side-nav-title">
	  <a href="/docs/cpp/guides/" >
	Programming Guides</a></h6></li>
	
   <li class="doc-side-nav-list-item">
     <a href="/docs/cpp/guides/base" >
     Abseil Fundamentals</a></li>
   <li class="doc-side-nav-list-item">
     <a href="/docs/cpp/guides/synchronization" >
     Synchronization</a></li>
   <li class="doc-side-nav-list-item">
     <a href="/docs/cpp/guides/strings" >
     Strings</a></li>
	 
  <li><h6 class="doc-side-nav-title">
  <a href="/docs/cpp/platforms/" class='current'>
   Platforms Guide</a></h6></li>
   
   <li class="doc-side-nav-list-item">
	<a href="/docs/cpp/platforms/platforms" >
	Supported Platforms</a></li>
	<li class="doc-side-nav-list-item">
	<a href="/docs/cpp/platforms/feature_checks" >
	Feature Check Macros</a></li>
 </ul>

</div>
<div class="col-sm-7 markdown">
<h2 id="abseil-compiler-flags">Abseil Compiler Flags</h2>

<p>The Abseil C++ code is compiled using flags indicated within this guide. Our
objective is to support as many warning flags as possible, to minimize the
chance that your code will be impacted by flags that you may need in your
development environment. However, given the plethora of possible compilation
configurations, that is not always possible, and we’ve found some flags to be
counter-productive.</p>

<p>This guide describes the warning flags we are using, per compiler. We do disable
some flags to keep our code as noise-free as possible. Notes on flags that we do
not support and have intentionally disabled are provided within this guide.
Separately, some flags are also disabled within existing tests. In both cases,
we will continue to work to reduce the number of flags we need to disable.</p>

<p>These flags (and flags sets) are defined in the Abseil code repository within
the
<a href="https://github.com/abseil/abseil-cpp/blob/master/absl/copts.bzl">copts.bzl</a>
file.</p>

<p class="note">
Note that, in general, Abseil treats all compiler <i>warnings</i> as
<b>errors</b> (<code>-Werror</code> in GCC/Clang, <code>/WX</code> in MSVC),
and our Kokoro continuous integration tests do likewise. However, we do not
enable "warnings as errors" within the GCC and Clang flag sets here; we can't
control what warnings future compilers may add to the existing flag sets. (We do
enable warnings as errors within the MSVC flag set.)
</p>

<h2 id="abseil-warning-flags">Abseil Warning Flags</h2>

<p>At a high level, Abseil defines two sets of flags:</p>

<ul>
  <li><code class="highlighter-rouge">ABSL_DEFAULT_COPTS</code></li>
  <li><code class="highlighter-rouge">ABSL_TEST_COPTS</code></li>
</ul>

<p><code class="highlighter-rouge">ABSL_TEST_COPTS</code> includes all flags within <code class="highlighter-rouge">ABSL_DEFAULT_COPTS</code> but
disables a number of them to avoid problems with certain tests. In general, you
should treat <code class="highlighter-rouge">ABSL_DEFAULT_COPTS</code> as the canonical list of Abseil compiler
flags. We hope to harmonize these flag sets in the future.</p>

<p>In practice, <code class="highlighter-rouge">ABSL_DEFAULT_COPTS</code> contains one of the following flag sets,
depending on the compiler it is invoked under:</p>

<ul>
  <li><code class="highlighter-rouge">ABSL_GCC_FLAGS</code> for GNU gcc compilers</li>
  <li><code class="highlighter-rouge">ABSL_LLVM_FLAGS</code> for Clang compilers</li>
  <li><code class="highlighter-rouge">ABSL_MSVC_FLAGS</code> for Visual Studio/msvc compilers</li>
</ul>

<p>These flag sets are documented below.</p>

<h3 id="gcc-flags">GCC Flags</h3>

<p>The <code class="highlighter-rouge">ABSL_GCC_FLAGS</code> set of compiler flags has the following characteristics:</p>

<ul>
  <li>All “normal” flags are set via <code class="highlighter-rouge">-Wall</code> and <code class="highlighter-rouge">-Wextra</code>. (Note that not “all”
flags are contained with the GCC <code class="highlighter-rouge">all</code> set.)</li>
  <li>Additionally, Abseil enables the following flags, which are generally
recommended for all C++ code:
    <ul>
      <li><code class="highlighter-rouge">-Wcast-qual</code></li>
      <li><code class="highlighter-rouge">-Wconversion-null</code></li>
      <li><code class="highlighter-rouge">-Wmissing-declarations</code></li>
      <li><code class="highlighter-rouge">-Woverlength-strings</code></li>
      <li><code class="highlighter-rouge">-Wpointer-arith</code></li>
      <li><code class="highlighter-rouge">-Wunused-local-typedefs</code></li>
      <li><code class="highlighter-rouge">-Wunused-result</code></li>
      <li><code class="highlighter-rouge">-Wvarargs</code></li>
      <li><code class="highlighter-rouge">-Wvla</code></li>
      <li><code class="highlighter-rouge">-Wwrite-strings</code></li>
    </ul>
  </li>
  <li>Abseil disables <code class="highlighter-rouge">-Wsign-compare</code> because of the presence of signed and
unsigned integer comparisons in our codebase (mostly between Abseil and the
standard library).</li>
</ul>

<p>References:</p>

<p><a href="https://gcc.gnu.org/onlinedocs/gcc/Warning-Options.html#Warning-Options">Options to Request or Suppress Warnings</a></p>

<h3 id="clang-flags">Clang Flags</h3>

<p>The <code class="highlighter-rouge">ABSL_LLVM_FLAGS</code> set of compiler flags is the most extensive set and
provides the most code analysis, which is why we recommend a Clang compiler.
The Clang compiler flag set has the following characteristics:</p>

<ul>
  <li>All “normal” flags are set via <code class="highlighter-rouge">-Wall</code>, <code class="highlighter-rouge">-Wextra</code> and <code class="highlighter-rouge">-Weverything</code>. (Note
that, like with GCC, not “all” flags are contained with the Clang <code class="highlighter-rouge">all</code>
set.)</li>
  <li><code class="highlighter-rouge">-Wconversion</code> is disabled to turn off the overly-broad set of implicit
conversion warnings. Many (but not all) of these implicit conversion warnings
are later turned on.</li>
  <li>Additionally, the following flags are disabled to prevent warnings based
on implicit type casts:
    <ul>
      <li><code class="highlighter-rouge">-Wno-double-promotion</code></li>
      <li><code class="highlighter-rouge">-Wno-float-conversion</code></li>
      <li><code class="highlighter-rouge">-Wno-old-style-cast</code></li>
      <li><code class="highlighter-rouge">-Wno-shorten-64-to-32</code></li>
      <li><code class="highlighter-rouge">-Wno-sign-conversion</code></li>
    </ul>
  </li>
  <li><code class="highlighter-rouge">-Wrange-loop-analysis</code> is disabled because Clang’s implementation only
ignores actual POD types; turning this warning on would require even small
value types such as <code class="highlighter-rouge">absl::string_view</code> to be defined as const references
within a range loop.</li>
  <li><code class="highlighter-rouge">-Wglobal-constructors</code> is disabled because some low-level initialization
abstractions (mostly internal) require them. In general, however, you should
avoid global constructors.</li>
  <li><code class="highlighter-rouge">-Wpadded</code> and <code class="highlighter-rouge">-Wpacked</code> are disabled because these flags are typically
used as advisory warnings, but we treat warnings as errors within Abseil code.</li>
  <li><code class="highlighter-rouge">-Wundef</code> is disabled because some Abseil dependencies
(<a href="https://github.com/google/cctz">CCTZ</a> and
<a href="http://www.pcg-random.org/">pcg_random</a>) use <code class="highlighter-rouge">#undef</code>. (We only do so on
macros we define ourselves for local use, to prevent the definition from
leaking globally.)</li>
  <li><code class="highlighter-rouge">-Wgcc-compat</code> is disabled because we want to use Clang-specific features in
a Clang compilation branch and not get unnecessary warnings about GCC.</li>
  <li><code class="highlighter-rouge">-Wcomma</code> and <code class="highlighter-rouge">-Wextra-semi</code> are disabled because they are still valid C++
code (and occur in cases of macro expansion).</li>
  <li><code class="highlighter-rouge">-Wformat-literal</code> is disabled because some of our logging code passes their
literal arguments to helper functions as non-literal variables.</li>
  <li><code class="highlighter-rouge">-Wswitch-enums</code> is disabled because it would break any users of existing
enums, if additional enum entries were added.</li>
</ul>

<p>References:</p>

<ul>
  <li><a href="https://clang.llvm.org/docs/ClangCommandLineReference.html">Clang Command Line Argument Reference</a></li>
  <li><a href="https://clang.llvm.org/docs/DiagnosticsReference.html">Diagnostic Flags in Clang</a></li>
</ul>

<h3 id="msvc-flags">MSVC Flags</h3>

<p>The <code class="highlighter-rouge">ABSL_MSVC_FLAGS</code> set of compiler flags is specific to MSVC/Visual Studio
and has the following characteristics:</p>

<ul>
  <li>All “level 3” flags are set via the <code class="highlighter-rouge">\W3</code> flag. (See
<a href="https://msdn.microsoft.com/en-us/library/thxezb7y.aspx">Warning Levels</a>).</li>
  <li>All warnings are treated as errors (as is the case above for Clang and GCC)
via the <code class="highlighter-rouge">\WX</code> flag.</li>
  <li>The following flags are disabled because they are advisory, and ignoring them
is better than treating them as errors:
    <ul>
      <li><code class="highlighter-rouge">/wd4005</code> prevents warnings about macro redefinitions.</li>
      <li><code class="highlighter-rouge">/wd4068</code> prevents warnings on unknown pragmas.</li>
      <li><code class="highlighter-rouge">/wd4244</code> prevents warnings on implicit conversions.</li>
      <li><code class="highlighter-rouge">/wd4267</code> prevents warnings on conversion from <code class="highlighter-rouge">size_t</code> to <code class="highlighter-rouge">int</code>.</li>
      <li><code class="highlighter-rouge">/wd4800</code> prevents warnings on implicit conversion to type
<code class="highlighter-rouge">bool</code>.</li>
    </ul>
  </li>
  <li>The following Windows macro definitions are also defined:
    <ul>
      <li><code class="highlighter-rouge">/DNOMINMAX</code> to prevent Windows overrides of <code class="highlighter-rouge">std</code> min/max functions.</li>
      <li><code class="highlighter-rouge">/DWIN32_LEAN_AND_MEAN</code> to reduce the amount of Windows-specific header
files.</li>
      <li><code class="highlighter-rouge">/D_CRT_SECURE_NO_WARNINGS</code> to prevent Windows from complaining about
standard C++ functions.</li>
    </ul>
  </li>
</ul>

<p>References:</p>

<ul>
  <li><a href="https://msdn.microsoft.com/en-us/library/fwkeyyhe.aspx">MSVC Compiler Options</a></li>
</ul>

</div>

<div id="toc" class="toc col-sm-2"></div>
</div>
</div>
</div>




<footer>
    <div class="container">
        <div class="left-links">
            <img src="/img/typography_white.png" style="height:24px;"/>
            <p class="description">&copy;2017 Abseil | Live at Head</p>
        </div>
        <div class="right-links">
            <div class="col-md-4 col-sm-4 col-xs-12 footer-documentation">
                <ul class="toggle">
                    <a href="/about/"><p class="right-link-headers">About Abseil</p></a>
                    <li><a href="/about/intro"><p>Introduction</p></a></li>
                    <li><a href="/about/philosophy"><p>Philosophy</p></a></li>
                    <li><a href="/about/compatibility"><p>Compatibility</p></a></li>
                    <li><a href="/about/design/"><p>Design Notes</p><a></li>
                 </ul>
            </div>
            <hr class="footer-sections" />
            <div class="col-md-3 col-sm-3 col-xs-12 footer-resources">
                <ul class="toggle">
                    <a href="/docs/"><p class="right-link-headers">Dev Guides</p></a>
                    <li><a href="/docs/cpp.html"><p>C++</p></a></li>
                    <li><a href="/blog/"><p>Abseil Blog</p></a></li>
                </ul>
                </ul>
            </div>
            <hr class="footer-sections" />
            <div class="col-md-5 col-sm-5 col-xs-12 footer-community">
                <ul class="toggle">
                    <a href="/community/"><p class="right-link-headers">Community</p></a>
                    <li><a href="https://github.com/abseil/" target="_blank"><p class="github community-links">GitHub</p></a></li>
                    <li><a href="https://twitter.com/abseilio" target="_blank"><p class="twitter community-links">Twitter</p></a></li>
                    <li><a href="http://stackoverflow.com/tags/abseil/" target="_blank"><p class="stack-overflow community-links">Stack Overflow</p></a></li>
                </ul>
            </div>
        </div>
    </div>
</footer>


    <script src="/libs/bootstrap/js/bootstrap.min.js"></script>
    <!-- Include SlickJS for carousel -->
    <script src="/js/slick.min.js"></script>
    <script src="/js/jquery.visible.min.js"></script>
    <!-- Include the common site javascript -->
    <script src="/js/common.js" type="text/javascript" charset="utf-8"></script>
    <!-- GA -->
    <script src="/js/waves.js"></script>
    <script src="/js/buttons.js"></script>
    
    

    
	
	<!-- Global Site Tag (gtag.js) - Google Analytics -->
	<script async src="https://www.googletagmanager.com/gtag/js?id=UA-106933809-1"></script>
	<script>
	  window.dataLayer = window.dataLayer || [];
	  function gtag(){dataLayer.push(arguments)};
	  gtag('js', new Date());

	  gtag('config', 'UA-106933809-1');
	</script>

  </body>
</html>
